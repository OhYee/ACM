---
title: U盘格式化 + 启动盘
date: 2017-04-01 20:53:42
categories: 笔记
tags:
keywords:
 - NTFS
 - FAT32
 - exFat
 - 格式化
 - PE
 - U盘启动盘
 - OTG
 - OTG读U盘
 - 占用空间
 - 大小
 - 簇
---
本身的U盘格式有问题,存在非常蛋疼的问题,抽时间重新格式化了一下U盘,发现还是有一些坑的  
<!--more-->

# 格式化U盘
首先先来看下名词解释,常见的U盘格式有 `FAT`,`FAT32`,`exFat`,`NTFS`  
在现在这个年代, FAT 显然已经淘汰了,那么其他的有什么特点呢  
{% fold 点击显/隐介绍%}
{% note info %}
**FAT32**  
FAT32是分区格式的一种  
这种格式采用 32 位的文件分配表,使其对磁盘的管理能力大大增强,突破了FAT16对每一个分区的容量只有 2GB 的限制  
由于现在的硬盘生产成本下降,其容量越来越大,运用FAT32的分区格式后,我们可以将一个大硬盘定义成一个分区而不必分为几个分区使用,大大方便了对磁盘的管理  
但由于FAT32分区内无法存放大于4GB的单个文件,且性能不佳,易产生磁盘碎片  
目前已被性能更优异的NTFS分区格式所取代
{% endnote %}

{% note success %}
**exFAT**  
exFAT是Microsoft在Windows Embeded 5.0以上中引入的一种适合于闪存的文件系统,为了解决FAT32等不支持4G及其更大的文件而推出  
对于闪存,NTFS文件系统不适合使用,exFAT更为适用  
对于磁盘则不太适用
{% endnote %}

{% note danger %}
**NTFS**
NTFS,是 WindowsNT 环境的文件系统  
新技术文件系统是Windows NT家族等的限制级专用的文件系统
NTFS取代了老式的FAT文件系统  
NTFS对FAT和HPFS作了若干改进,例如,支持元数据,并且使用了高级数据结构,以便于改善性能、可靠性和磁盘空间利用率,并提供了若干附加扩展功能  

该文件系统的详细定义属于**商业秘密** ,微软已经将其注册为**知识产权产品**
{% endnote %}

{% endfold %}

划重点!!
**NTFS 格式是微软有版权的,所以这个不是随便就能用的,因此这个格式的U盘你在非 Windows 家族的系统上很可能不能使用**  
这也就是许多手机OTG不能正确读取U盘的原因  

<img src="/post/img/Udisk_formatting.jpg" width="200px" height="auto" align="right" >
因此应该把文件系统格式化成 exFAT   
这样即满足了能够存放4G以上的文件,同时还能保证手机能够通过OTG读取手机  


再来看为什么文件的大小和占用空间不一样  
可以看到,在格式化的时候有一个 **分配单元大小** ,这个就是你U盘的最小单位,如果一个文件小于这个大小,那么它将占用整个这个单元大小的空间  
显然,如果大文件比较多这个功能显然可以加快一些读取、处理的速度(被分割成较少块)  
而如果小文件比较多,显然会非常浪费空间(之前U盘就是11G的东西占了40G空间)  

因此需要根据文件大小挑选更加合适的大小,比如我的U盘更多是一些ACM的代码,一般都是 1~2K  
那么就可以把空间大小设置成 1K 或者 4K   


那么选项就选好了  
选择 exFAT 的文件系统,单元大小根据需要即可  

# PE系统
{% fold 显/隐概念 %}{% note warning %}
**PE**  
PE,Windows PE Windows Preinstallation Environment,Windows预安装环境,微软在2002年7月22日发布,带有限服务的最小Win32子系统,基于以保护模式运行的Windows XP Professional内核  
Windows预先安装环境是简化版的Windows XP、Windows Server 2003、Windows Vista、Windows 7 、Windows 8和Windows 10  
WinPE是以光盘或其他可携设备作媒介  
WinPE作用是方便大企业作出工作站和服务器的企划、给“原始设备制造商”制造自定义的Windows操作系统、取代MS-DOS的磁片  
Windows PE可理解为Windows的LiveCD  
{% endnote %}{% endfold %}

PE不仅能在安装系统时有一个更友善的界面,还能在电脑出现故障时能够辅助维修   
而一个功能完善的PE不仅能够运行常见的软件,甚至还能联网  
因此一个比较全面的PE非常有用(虽然由于驱动的问题分辨率可能会比较诡异)  

老毛桃、大白菜都是比较常见的PE系统,不过由于智能刷入他们整合好的系统,因此有时候不是那么符合我们的要求  
更好地选择是找一个更加适合自己的iso文件  
许多论坛上都有整合好的iso文件,但是要注意**有的iso里有一些后门**,因此选择一个可靠的来源非常关键  

找好iso镜像后,把它解压到U盘根目录,然后使用 `BOOTICE` 把U盘的主引导记录设置成 `Ultral USB-HDD+`  
分区引导设置成 `BOOTMGR引导程序`  
这样开机时在 BIOS 里选择U盘启动即可进入到 PE 里  
